<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blackbeard AI Chat</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; background: #000; color: #fff; }
        #chatbox { width: 100%; max-width: 400px; margin: auto; border: 1px solid #ccc; padding: 10px; border-radius: 10px; background: #222; }
        #messages { height: 300px; overflow-y: auto; text-align: left; padding: 10px; border-radius: 5px; }
        .message { padding: 8px; border-radius: 5px; margin: 5px 0; }
        .user { background: #007BFF; color: white; text-align: right; }
        .bot { background: #444; color: white; text-align: left; }
        .typing { font-style: italic; color: gray; }
        button { padding: 10px 20px; margin-top: 10px; cursor: pointer; background: #007BFF; border: none; color: white; border-radius: 5px; }
    </style>
</head>
<body>

<h2>☠️ Talk to Blackbeard ☠️</h2>
<div id="chatbox">
    <div id="messages"></div>
    <input type="text" id="userInput" placeholder="Ask Blackbeard something..." />
    <button onclick="sendMessage()">Send</button>
</div>

<audio id="audioPlayer" controls style="display: none;"></audio>

<script>
const ZAPIER_WEBHOOK_URL = "https://hooks.zapier.com/hooks/catch/21580318/2ai6quc/"; 

function sendMessage() {
    const userInput = document.getElementById("userInput").value;
    if (!userInput) {
        alert("Enter a message!");
        return;
    }

    const messagesDiv = document.getElementById("messages");
    messagesDiv.innerHTML += `<div class='message user'>${userInput}</div>`;
    messagesDiv.innerHTML += `<div class='message bot typing'>Blackbeard is thinking...</div>`;
    document.getElementById("userInput").value = "";

    fetch(ZAPIER_WEBHOOK_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ user_message: userInput })
    })
    .then(response => response.json())
    .then(data => {
        document.querySelector(".typing").remove();
        if (data.text) {
            messagesDiv.innerHTML += `<div class='message bot'>${data.text}</div>`;
        }
        if (data.audioUrl) {
            let audio = document.getElementById("audioPlayer");
            audio.src = data.audioUrl;
            audio.style.display = "block";
            audio.play();
        }
    })
    .catch(err => {
        console.error("Error:", err);
        document.querySelector(".typing").innerText = "An error occurred!";
    });
}
</script>

</body>
</html>
